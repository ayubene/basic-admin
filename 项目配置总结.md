# 项目配置总结

## ✅ 已完成的配置

### 1. 真实接口配置
- ✅ 配置了 Vite 代理，指向 `http://10.1.23.80:8082/shiye-retail`
- ✅ 用户列表接口: `/system/user/list`
- ✅ 部门列表接口: `/system/department/departList`
- ✅ 自动转换后端数据格式

### 2. Token 认证
- ✅ 所有请求自动添加 token（包括 BasicTable、BasicSelect）
- ✅ Token 格式: `Authorization: Bearer {token}`
- ✅ 401 错误自动清除 token
- ✅ 提供 token 管理工具函数

### 3. 组件配置

#### BasicTable (用户列表)
```vue
<BasicTable
  query-url="/system/user/list"
  :columns="columns"
/>
```
- 自动分页
- 支持搜索（姓名、状态、部门）
- 部门搜索选项动态加载

#### BasicSelect (部门选择)
```vue
<BasicSelect
  v-model="form.department"
  list-url="/system/department/departList"
  value-key="id"
  label-key="name"
/>
```
- 远程数据加载
- 显示部门名称，保存部门 ID

## 📁 项目结构

```
src/
├── api/
│   ├── config.ts          # axios 配置（手动调用的 API）
│   ├── user.ts            # 用户管理 API
│   └── department.ts      # 部门 API
├── utils/
│   ├── request.ts         # 全局请求配置（BasicComponents）
│   └── auth.ts            # Token 管理工具
├── views/
│   └── UserManagementView.vue  # 用户管理页面
└── main.ts                # 应用入口
```

## 🔧 配置文件

### vite.config.ts
```typescript
proxy: {
  '/system': {
    target: 'http://10.1.23.80:8082/shiye-retail',
    changeOrigin: true,
    rewrite: (path) => path
  }
}
```

### src/utils/request.ts
- 配置 srit-basic-components 的请求拦截器
- 自动添加 token
- 自动转换数据格式

### src/api/config.ts
- 创建独立的 axios 实例
- 用于手动调用的 API
- 同样会自动添加 token

## 🚀 启动项目

```bash
npm run dev
```

访问: http://localhost:5175/

## 🧪 测试 Token

### 1. 设置 token
```javascript
localStorage.setItem('token', 'test-token-123')
```

### 2. 查看请求
打开 Network 标签，查看请求头：
```
Authorization: Bearer test-token-123
```

### 3. 清除 token
```javascript
localStorage.removeItem('token')
```

## 📝 使用示例

### 设置 Token (登录后)
```typescript
import { setToken } from '@/utils/auth'

const handleLogin = async () => {
  const response = await loginApi({ username, password })
  setToken(response.data.token)
  router.push('/')
}
```

### 清除 Token (登出)
```typescript
import { logout } from '@/utils/auth'

const handleLogout = () => {
  logout()
  router.push('/login')
}
```

### 检查登录状态
```typescript
import { isAuthenticated } from '@/utils/auth'

if (!isAuthenticated()) {
  router.push('/login')
}
```

## 🎯 数据流

```
用户操作
  ↓
BasicTable/BasicSelect 发起请求
  ↓
请求拦截器添加 token
  ↓
Vite 代理转发 (开发环境)
  ↓
后端服务 (http://10.1.23.80:8082/shiye-retail)
  ↓
响应拦截器处理数据格式
  ↓
组件渲染
```

## 📚 相关文档

- `API接口配置说明.md` - 接口配置详细说明
- `Token配置说明.md` - Token 配置和使用指南
- `测试Token.md` - Token 功能测试步骤
- `接口配置总结.md` - 接口配置快速参考

## ⚠️ 注意事项

1. **开发环境 vs 生产环境**
   - 开发: 使用 Vite 代理
   - 生产: 需要配置完整 URL 或 Nginx 代理

2. **Token 格式**
   - 默认: `Authorization: Bearer {token}`
   - 可根据后端要求修改

3. **Token 存储**
   - 当前使用 localStorage
   - 可改为 sessionStorage 或 cookie

4. **401 错误处理**
   - 自动清除 token
   - 需要手动添加路由跳转到登录页

## 🔜 后续工作

1. [ ] 创建登录页面
2. [ ] 实现登录接口
3. [ ] 添加路由守卫
4. [ ] 实现 token 刷新机制
5. [ ] 添加其他页面的接口配置
6. [ ] 完善错误处理
7. [ ] 添加 loading 状态
8. [ ] 优化用户体验

## 🎉 总结

项目已经完成了基础的接口配置和 token 认证：

✅ 所有请求都会自动添加 token  
✅ BasicTable 和 BasicSelect 都使用真实接口  
✅ 数据格式自动转换  
✅ 错误统一处理  
✅ 提供完整的 token 管理工具  

现在可以开始开发其他功能了！
